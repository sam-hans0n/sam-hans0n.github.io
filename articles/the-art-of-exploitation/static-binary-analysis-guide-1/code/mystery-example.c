#include <stdio.h>
#include <string.h>
#include <stdlib.h>

/////////////////////////////////////////////////////////////////////////////////
// Created by Sam Hanson
// 2/21/2020
// Classic buffer overflow vulnerability
//
// ASLR has been disabled via the command:
//    sudo bash -c 'echo 0 > /proc/sys/kernel/randomize_va_space'
//
// Compiled with:
//    gcc mystery-example.c -z execstack -z norelro -fno-stack-protector -D_FORTIFY_SOURCE=0 -ggdb -o mystery-example
/////////////////////////////////////////////////////////////////////////////////


void aFunction(char* name) {
  char buff[10];
  
  strcpy(buff, name);
  printf("Hello, %s!\n", buff);
}

int main(int argc, char *argv[]) {
  
  if(argc < 2) {
    printf("Program has finished.\n");
    exit(0);
  }

  aFunction((char*) argv[1]);
  
  exit(0);
}
